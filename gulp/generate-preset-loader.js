var gulp = require('gulp')
var autoImports = require('../')

var header = `
// Do not edit this file.
// Run "gulp" to generate this file instead.`

var presetsTemplate = `
var presets = {
$format[names]
}

module.exports = presets;
`
var typesTemplate = `
export type preset =
$format[typeDefinitions]
`

gulp.task('preset-loader', function () {
	var dest = 'core/content-generators'

	return gulp
		.src('./presets/*.js')
		.pipe(
			autoImports({
				format: {
					names: '  $name: require("$path"),',
				},
				dest,
				fileName: 'preset-settings.js',
				template: presetsTemplate,
				header,
			}),
		)
		.pipe(gulp.dest(dest))
})

gulp.task('preset-types-generator', function () {
	var dest = './'

	return gulp
		.src('./presets/*.js')
		.pipe(
			autoImports({
				format: {
					typeDefinitions: "  | '$name'",
				},
				dest,
				fileName: 'preset-types.ts',
				template: typesTemplate,
				header,
			}),
		)
		.pipe(gulp.dest(dest))
})
